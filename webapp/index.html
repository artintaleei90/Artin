<!-- webapp/index.html -->
<!DOCTYPE html>
<html lang="fa">
<head>
  <meta charset="UTF-8">
  <title>فروشگاه هالستون</title>
  <script src="https://telegram.org/js/telegram-web-app.js"></script>
  <style>
    body {
      font-family: sans-serif;
      direction: rtl;
      background: #f4f4f4;
      padding: 20px;
    }
    .product {
      background: white;
      padding: 10px;
      margin-bottom: 20px;
      border-radius: 10px;
      border: 1px solid #ddd;
    }
    .product img {
      width: 100%;
      border-radius: 10px;
    }
    .product-title {
      font-weight: bold;
      margin: 10px 0;
    }
    input, button {
      width: 100%;
      margin-top: 10px;
      padding: 10px;
      font-size: 16px;
    }
    button {
      background: #0088cc;
      color: white;
      border: none;
      border-radius: 5px;
    }
  </style>
</head>
<body>

  <h2>🛍 فروشگاه هالستون</h2>

  <div class="product">
    <img src="https://halston.ir/uploads/1303.jpg" alt="مانتو کرم">
    <div class="product-title">1303 - مانتو کرم</div>
    <div>قیمت: 747,000 تومان</div>
    <label>تعداد:</label>
    <input type="number" id="count-1303" min="0" value="0">
  </div>

  <div class="product">
    <img src="https://halston.ir/uploads/3390.jpg" alt="مانتو مشکی">
    <div class="product-title">3390 - مانتو مشکی</div>
    <div>قیمت: 697,000 تومان</div>
    <label>تعداد:</label>
    <input type="number" id="count-3390" min="0" value="0">
  </div>

  <h3>📝 مشخصات شما</h3>
  <input type="text" id="name" placeholder="نام کامل">
  <input type="text" id="phone" placeholder="شماره تماس">
  <input type="text" id="city" placeholder="شهر">
  <input type="text" id="address" placeholder="آدرس">

  <button onclick="submitOrder()">ثبت سفارش</button>

  <script>
    const tg = window.Telegram.WebApp;
    tg.expand();

    const products = {
      "1303": { name: "مانتو کرم - پک ۴ عددی", price: 747000 },
      "3390": { name: "مانتو مشکی - پک ۶ عددی", price: 697000 }
    };

    function submitOrder() {
      const orders = [];

      for (const code in products) {
        const count = parseInt(document.getElementById(`count-${code}`).value);
        if (count > 0) {
          orders.push({ code, ...products[code], count });
        }
      }

      const name = document.getElementById("name").value.trim();
      const phone = document.getElementById("phone").value.trim();
      const city = document.getElementById("city").value.trim();
      const address = document.getElementById("address").value.trim();

      if (!orders.length || !name || !phone || !city || !address) {
        alert("تمام فیلدها را پر کنید و حداقل یک محصول انتخاب کنید.");
        return;
      }

      tg.sendData(JSON.stringify({ name, phone, city, address, orders }));
    }
  </script>
</body>
</html>
